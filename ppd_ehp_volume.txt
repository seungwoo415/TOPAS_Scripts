# This example demonstrates the three different ways one can bin results by energy. Adjust the value of EBinEnergy to see the effect.
#
# IncidentTrack means we bin based on the energy of the track that was initially
# incident on the scoring volume, even though the track that finally delivers the
# scored energy is likely to be not this track but one of its resultng delta rays.
# This is the default setting.
# It is set this way because the original use of energy binning was to study how
# proton therapy dose due to various energy protons incident on the patient.
#
# PreStep means we bin based on the kinetic energy of the track at the time
# that it deposited the dose.
# This is generally used when one wants to score a spectrum.
# So, for example, if you adjust Quantity below to Fluence, then the scored
# value is what is referred to in the literature as a Spectral Fluence.
#
# DepositedInStep means we bin based on the energy that was deposited in the step.
# You can use this setting to see that almost all actual energy deposits occur
# in small amounts spread along the track.

# World 
s:Ge/World/Material  = "Air"
d:Ge/World/HLX       = 50. cm
d:Ge/World/HLY       = 50. cm
d:Ge/World/HLZ       = 50. cm
b:Ge/World/Invisible = "True"

# Photodiode 
s:Ge/SiDiode/Type     = "TsBox"
s:Ge/SiDiode/Parent   = "World"
s:Ge/SiDiode/Material = "G4_Si"
d:Ge/SiDiode/HLX      = 10. cm
d:Ge/SiDiode/HLY      = 10. cm
d:Ge/SiDiode/HLZ      = 0.05 um
s:Ge/SiDiode/Color = "Blue" 

# PrimaryScorer
s:Sc/PrimaryScorer/Component                 = "SiDiode" 
s:Sc/PrimaryScorer/Quantity                 = "EnergyDeposit"
b:Sc/PrimaryScorer/OutputToConsole           = "True"
s:Sc/PrimaryScorer/OutputType = "csv"
s:Sc/PrimaryScorer/OutputFile = "primary"
s:Sc/PrimaryScorer/IfOutputFileAlreadyExists = "Overwrite"
sc:Sc/PrimaryScorer/EBinEnergy               = "IncidentTrack"
#s:Sc/PrimaryScorer/OnlyIncludeParticlesOfGeneration = "Primary"
i:Sc/PrimaryScorer/EBins        = 100             # Number of energy bins - just remove bins for total energy deposition
d:Sc/PrimaryScorer/EBinMin      = 0 keV       # Minimum energy
d:Sc/PrimaryScorer/EBinMax      = 200 keV       # Maximum energy
sv:Sc/PrimaryScorer/Report      = 1 "Count_In_Bin" # counts num of particles  


# IncidentTrack - what is the energy of the given incident energies (here it is only 500 keV) are incident to the Scorer
# DepositedInStep - how much of the incident energy was deposited in each step (interaction)
# The only difference is - maybe i need to change to primary generation 

# there is a difference when "Primary" generation is on vs. off for DepositedInStep - looks like there are electrons
# generated and then they're generating more photons? - can verify that e- are generated using statement below
#sv:Sc/EnergyDepInLeadBox/OnlyIncludeParticlesNamed = 1 "e-"

# SecondaryScorer
s:Sc/SecondaryScorer/Component                 = "SiDiode" 
s:Sc/SecondaryScorer/Quantity                 = "EnergyDeposit"
b:Sc/SecondaryScorer/OutputToConsole           = "True"
s:Sc/SecondaryScorer/OutputType = "csv"
s:Sc/SecondaryScorer/OutputFile = "secondary"
s:Sc/SecondaryScorer/IfOutputFileAlreadyExists = "Overwrite"
sc:Sc/SecondaryScorer/EBinEnergy               = "IncidentTrack"
s:Sc/SecondaryScorer/OnlyIncludeParticlesOfGeneration = "Secondary"
i:Sc/SecondaryScorer/EBins        = 1             # Number of energy bins - just remove bins for total energy deposition
d:Sc/SecondaryScorer/EBinMin      = 0 keV       # Minimum energy
d:Sc/SecondaryScorer/EBinMax      = 200 keV       # Maximum energy
sv:Sc/SecondaryScorer/Report      = 1 "Count_In_Bin" # counts num of particles 

# SurfaceScorer
s:Sc/SurfaceScorer/Component                 = "SiDiode" 
s:Sc/SurfaceScorer/Quantity                 = "SurfaceTrackCount"
s:Sc/SurfaceScorer/Surface                          = "SiDiode/ZPlusSurface"
b:Sc/SurfaceScorer/OutputToConsole           = "True"
s:Sc/SurfaceScorer/OutputType = "csv"
s:Sc/SurfaceScorer/OutputFile = "surface"
s:Sc/SurfaceScorer/IfOutputFileAlreadyExists = "Overwrite"
s:Sc/SurfaceScorer/OnlyIncludeParticlesOfGeneration = "Primary"
i:Sc/SurfaceScorer/EBins        = 50              # Number of energy bins - just remove bins for total energy deposition
d:Sc/SurfaceScorer/EBinMin      = 0 keV       # Minimum energy
d:Sc/SurfaceScorer/EBinMax      = 200 keV       # Maximum energy
sv:Sc/SurfaceScorer/Report      = 1 "Count_In_Bin" # counts num of particles

# View 
#s:Gr/ViewA/Type                            = "OpenGL"
i:Gr/ViewA/WindowSizeX                      = 900
i:Gr/ViewA/WindowSizeY                      = 900
d:Gr/ViewA/Theta                            = 55 deg
d:Gr/ViewA/Phi                              = 20 deg
s:Gr/ViewA/Projection                       = "Perspective"
d:Gr/ViewA/PerspectiveAngle                 = 30 deg
u:Gr/ViewA/Zoom                             = 1.3
b:Gr/ViewA/HiddenLineRemovalForTrajectories = "True"

# PHYSICS LIST
s:Ph/ListName         = "Gamma"
s:Ph/Gamma/Type     = "Geant4_Modular"
sv:Ph/Gamma/Modules = 1 "g4em-standard_opt3"

# Source - Co-57 
s:So/source/Type = "Beam" 
s:So/source/Component = "BeamPosition"
s:So/source/BeamPositionDistribution = "None" # None, Flat or Gaussian
#s:So/source/BeamPositionCutoffShape = "Ellipse" # Rectangle or Ellipse (if Flat or Gaussian)
#d:So/source/BeamPositionCutoffX = 10. cm # X extent of position (if Flat or Gaussian)
#d:So/source/BeamPositionCutoffY = 10. cm # Y extent of position (if Flat or Gaussian)
#d:So/source/BeamPositionSpreadX = 0.65 cm # X standard deviation (used only if Gaussian)
#d:So/source/BeamPositionSpreadY = 0.65 cm # Y standard deviation (used only if Gaussian)
s:So/source/BeamAngularDistribution = "None" # None, Flat or Gaussian
#d:So/source/BeamAngularCutoffX = 90. deg # X cutoff of angular distrib (if Flat or Gaussian)
#d:So/source/BeamAngularCutoffY = 90. deg # Y cutoff of angular distrib (if Flat or Gaussian)
#d:So/source/BeamAngularSpreadX = 0.0032 rad # X standard deviation of angular distribution (used only if Gaussian)
#d:So/source/BeamAngularSpreadY = 0.0032 rad # Y standard deviation of angular distribution (used only if Gaussian)
s:So/source/BeamParticle               = "gamma"
s:So/source/BeamEnergySpectrumType    = "continuous"
dv:So/source/BeamEnergySpectrumValues  = 2 122 136 keV # https://gammaray.inl.gov/SiteAssets/catalogs/ge/pdf/co57.pdf
uv:So/source/BeamEnergySpectrumWeights = 2 0.89 0.11
u:So/source/BeamEnergySpread           = 0 # Cd-109 has two main peaks, although 122 kev is about 8 times more abundant
ic:So/source/NumberOfHistoriesInRun    = 100000

Ge/BeamPosition/Parent = "World"
Ge/BeamPosition/TransX = 0.0 cm
Ge/BeamPosition/TransZ = -10.0 cm
Ge/BeamPosition/TransY = 0.0 mm
Ge/BeamPosition/RotX   = 0 deg



#b:Ts/PauseBeforeQuit = "True"
