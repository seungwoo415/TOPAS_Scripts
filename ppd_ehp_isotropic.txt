# This example demonstrates the three different ways one can bin results by energy. Adjust the value of EBinEnergy to see the effect.
#
# IncidentTrack means we bin based on the energy of the track that was initially
# incident on the scoring volume, even though the track that finally delivers the
# scored energy is likely to be not this track but one of its resultng delta rays.
# This is the default setting.
# It is set this way because the original use of energy binning was to study how
# proton therapy dose due to various energy protons incident on the patient.
#
# PreStep means we bin based on the kinetic energy of the track at the time
# that it deposited the dose.
# This is generally used when one wants to score a spectrum.
# So, for example, if you adjust Quantity below to Fluence, then the scored
# value is what is referred to in the literature as a Spectral Fluence.
#
# DepositedInStep means we bin based on the energy that was deposited in the step.
# You can use this setting to see that almost all actual energy deposits occur
# in small amounts spread along the track.

# World 
s:Ge/World/Material  = "Air"
d:Ge/World/HLX       = 1. cm
d:Ge/World/HLY       = 1. cm
d:Ge/World/HLZ       = 1. cm
b:Ge/World/Invisible = "True"

# Photodiode 
s:Ge/SiDiode/Type     = "TsBox"
s:Ge/SiDiode/Parent   = "World"
s:Ge/SiDiode/Material = "G4_Si"
d:Ge/SiDiode/HLX      = 10. um
d:Ge/SiDiode/HLY      = 10. um
d:Ge/SiDiode/HLZ      = 0.2 um

# Scorer
s:Sc/MYScorer/Quantity                    = "PhaseSpace"
b:Sc/MyScorer/OutputToConsole             = "True"
s:Sc/MyScorer/Surface                     = "SiDiode/ZMinusSurface"
s:Sc/MyScorer/OutputType                  = "ASCII" # ASCII, Binary, Limited or ROOT
s:Sc/MyScorer/OutputFile                  = "ppd_ehp_isotropic"
i:Sc/MyScorer/OutputBufferSize            = 1000
b:Sc/MyScorer/IncludeTOPASTime = "True" # Time used by TimeFeatures for this history
b:Sc/MyScorer/IncludeTimeOfFlight = "True" # Time of Flight of this particle from start of history to scoring plane
b:Sc/MyScorer/IncludeRunID = "True"
b:Sc/MyScorer/IncludeEventID = "True"
b:Sc/MyScorer/IncludeTrackID = "True"
b:Sc/MyScorer/IncludeParentID = "True" # Track ID of parent particle
b:Sc/MyScorer/IncludeCharge = "True"
b:Sc/MyScorer/IncludeCreatorProcess = "True"
b:Sc/MyScorer/IncludeVertexInfo = "True" # Initial KE, Position and Momentum
b:Sc/MyScorer/IncludeSeed = "True"
s:Sc/MyScorer/IfOutputFileAlreadyExists   = "Overwrite"

# View 
#s:Gr/ViewA/Type                            = "OpenGL"
i:Gr/ViewA/WindowSizeX                      = 900
i:Gr/ViewA/WindowSizeY                      = 900
d:Gr/ViewA/Theta                            = 55 deg
d:Gr/ViewA/Phi                              = 20 deg
s:Gr/ViewA/Projection                       = "Perspective"
d:Gr/ViewA/PerspectiveAngle                 = 30 deg
u:Gr/ViewA/Zoom                             = 1.3
b:Gr/ViewA/HiddenLineRemovalForTrajectories = "True"

# PHYSICS LIST
s:Ph/ListName         = "Gamma"
s:Ph/Gamma/Type     = "Geant4_Modular"
sv:Ph/Gamma/Modules = 1 "g4em-standard_opt3"

# Source Geometry 
d:Ge/Source/TransX = 0 cm
d:Ge/Source/TransY = 0 cm
d:Ge/Source/TransZ = 1 cm

# Source - Co-57 
s:So/source/Type = "Isotropic" 
s:So/source/Component = "BeamPosition"
s:So/source/BeamParticle               = "gamma"
s:So/source/BeamEnergySpectrumType    = "continuous"
dv:So/source/BeamEnergySpectrumValues  = 2 122 136 keV # https://gammaray.inl.gov/SiteAssets/catalogs/ge/pdf/co57.pdf
uv:So/source/BeamEnergySpectrumWeights = 2 0.89 0.11
u:So/source/BeamEnergySpread           = 0 # Cd-109 has two main peaks, although 122 kev is about 8 times more abundant
ic:So/source/NumberOfHistoriesInRun    = 1000000

#b:Ts/PauseBeforeQuit = "True"
